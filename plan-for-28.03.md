# План на сегодня: Завершение регистрации и начало логина

**Дата:** 28 марта 2025  
**Цель:** Завершить `/register` (готово) и начать POST `/login` в Nest.js с Prisma.  
**Контекст:**
- Access-токен — в `useState` на фронте (Next.js).
- Refresh-токен — в `HttpOnly` cookie (добавим при логине).
- Redux и `localStorage` не используем.  
  **Общее время:** 2-3 часа (с учётом текущего прогресса).  
  **Стек:** Nest.js (бэк), Next.js (фронт), Tailwind (стили), Prisma (ORM), PostgreSQL (база).

---

## Выполнено: POST /register ✅
- **Результат:** Рабочий `/auth/register` с хешированием, проверкой уникальности и валидацией.
- **Статус:** Готово к 13:00-13:30.

---

## Перерыв: Житейские дела и еда (1.5 часа)
- **Время:** 13:30–15:00
- **Задача:** Отойти по делам, приготовить говяжью печень с луком и гарниром.
- **Шаги:**
    1. Реши дела.
    2. Приготовь еду (рецепт выше).
    3. Поешь и отдохни перед кодом.

---

## Цикл 1: Настройка POST /login (45 минут)
- **Время:** 15:00–15:45
- **Задача:** Создать базовый логин с выдачей access-токена.
- **Шаги:**
    1. Добавь метод в контроллер для `/auth/login`.
    2. В сервисе проверь email, сравни хеш пароля.
    3. Настрой выдачу access-токена (JWT) в ответе.
    4. Обрабатывай ошибки (неверный email/пароль).
    5. Протестируй в Insomnia:
        - Корректные данные — жди токен.
        - Неверные данные — жди ошибку.

- **Пауза:** 15:45–15:55 (10 минут) — чай, растяжка.

---

## Цикл 2: Добавление refresh-токена (опционально, 45 минут)
- **Время:** 15:55–16:40
- **Задача:** Расширить `/login` с refresh-токеном в cookie.
- **Шаги:**
    1. Создай модель для refresh-токенов в Prisma.
    2. Настрой выдачу refresh-токена (JWT) в `HttpOnly` cookie.
    3. Сохраняй refresh-токен в базу.
    4. Проверь в Insomnia: токен в JSON, cookie в ответе.

---

## Итог дня
- **Результат:** Рабочий `/register` и базовый `/login` (минимум с access-токеном).
- **Дальше:** Завтра — `/refresh` для восстановления сессии.

## Советы
- Insomnia — твой друг, проверяй каждый шаг.
- Не торопись с refresh-токеном, если устал — оставь на завтра.
- Пиши, если застрянешь — я подскажу без копипасты.

**Ты уже сделал регистрацию — логин будет следующим шагом к fullstack!**
